-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer
local remote = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("M1Request")

-- Variables
local spamActive = false
local spamDelay = 0.005 -- délai minimal (5ms) auto-optimisé

-- Fonction spam M1
local function startSpam()
    if spamActive then return end
    spamActive = true
    task.spawn(function()
        while spamActive do
            pcall(function()
                remote:FireServer(2)
            end)
            task.wait(spamDelay)
        end
    end)
end

local function stopSpam()
    spamActive = false
end

-- UI simple
local PlayerGui = player:WaitForChild("PlayerGui")
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "M1SpamGui"
ScreenGui.Parent = PlayerGui
ScreenGui.ResetOnSpawn = false

local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 280, 0, 140)
MainFrame.Position = UDim2.new(0.5, -140, 0.5, -70)
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
MainFrame.BackgroundTransparency = 0.15
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Parent = ScreenGui

local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Text = "M1 Spam Controller"
Title.Font = Enum.Font.GothamBold
Title.TextSize = 18
Title.TextColor3 = Color3.fromRGB(210, 210, 230)
Title.BackgroundTransparency = 1
Title.Size = UDim2.new(1, 0, 0, 30)
Title.Position = UDim2.new(0, 0, 0, 0)
Title.Parent = MainFrame

local ToggleBtn = Instance.new("TextButton")
ToggleBtn.Name = "ToggleBtn"
ToggleBtn.Text = "Start Spam"
ToggleBtn.Font = Enum.Font.Gotham
ToggleBtn.TextSize = 16
ToggleBtn.TextColor3 = Color3.fromRGB(25, 25, 25)
ToggleBtn.BackgroundColor3 = Color3.fromRGB(40, 200, 120)
ToggleBtn.Size = UDim2.new(0, 120, 0, 40)
ToggleBtn.Position = UDim2.new(0, 10, 0, 50)
ToggleBtn.Parent = MainFrame
ToggleBtn.AutoButtonColor = true
ToggleBtn.BorderSizePixel = 0

ToggleBtn.MouseButton1Click:Connect(function()
    if spamActive then
        stopSpam()
        ToggleBtn.Text = "Start Spam"
    else
        startSpam()
        ToggleBtn.Text = "Stop Spam"
    end
end)
